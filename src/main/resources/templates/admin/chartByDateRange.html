<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset=utf-8>
    <meta http-equiv=X-UA-Compatible content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="refresh" content="600"/>
    <!-- Font Awesome -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
<!-- Google Fonts Roboto -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
<!-- Bootstrap core CSS -->
<link rel="stylesheet" href="../css/bootstrap.css">
<link rel="stylesheet" href="../css/dashboard.css">
<link rel=icon href=../img/favicon.ico>
<title>CSCParts - Dashboard</title>

  </head>
  <body>
    <header>
      <!-- Bootstrap NavBar -->
      <div th:replace="headerLayout :: header(isFullScreen=${isFullScreen})"> </div>
  </header>
  <div class="container-fluid">
    <div class="row">
      <th:block th:if=${!isFullScreen}>
      <div th:replace="sideBarMenuLayout :: sideBarMenu(homeListClass='nav-item',todayListClass='nav-item bg-info',thisMonthListClass='nav-item',lastMonthListClass='nav-item',last3MonthsListClass='nav-item',homeLinkClass='nav-link',todayLinkClass='nav-link text-warning',thisMonthLinkClass='nav-link',lastMonthLinkClass='nav-link',last3MonthsLinkClass='nav-link')"> </div>
    </th:block>
            <main role="main" th:class="${isFullScreen?'col-md-12 ml-sm-auto col-lg-12 px-md-1':'col-md-9 ml-sm-auto col-lg-10 px-md-1'}">
              <div class="col-md-12">
                <div class="row px-2 mt-3" style="margin-left: 5%;">
                  <div class="col-12">
                    <span class="h3">DASHBOARD</span><span class="h6" th:text="${' Quotes , Orders & Invoices -  Today ('+toDay+')'}"></span>
                  </div>
                  
                </div>
                 <div class="album py-3 px-2 bg-light">
                  <div class="row">
                      <div class="col-md-4">
                        <div th:replace="admin/dashboardCardLayout :: cardFields(isFullScreen=${isFullScreen},cardTitle='Quotes',guageDiv='guage_div_quotes',totalValue=${salesQuotesDaily},totalStyle='background-color: #00bfff;',targetValue=${salesQuotesTargetDaily},targetStyle='background-color: #ff85e6;',qtyValue=${salesQuotesQtyDaily}, qtyTarget=${salesQuotesTargetQtyDaily},avgValue=${averageDailyQuotes},avgTarget=${averageDailyQuotesTarget},avgProfitValue=${averageDailyQuotesProfit},avgProfitTarget=${averageDailyQuotesProfitTarget},graphDiv='graph_div_quotes')"></div>
                      </div>
                      <div class="col-md-4">
                        <div th:replace="admin/dashboardCardLayout :: cardFields(isFullScreen=${isFullScreen},cardTitle='Orders',guageDiv='guage_div_orders',totalValue=${salesOrderedDaily},totalStyle='background-color: #f9ae06;', targetValue=${salesOrderedTargetDaily},targetStyle='background-color: #fff67e;color:black', qtyValue=${salesOrderedQtyDaily}, qtyTarget=${salesOrderedTargetQtyDaily},avgValue=${averageDailyOrders},avgTarget=${averageDailyOrdersTarget},avgProfitValue=${averageDailyOrdersProfit},avgProfitTarget=${averageDailyOrdersProfitTarget},graphDiv='graph_div_orders')"> </div>
                      </div>
                      <div class="col-md-4">
                        <div th:replace="admin/dashboardCardLayout :: cardFields(isFullScreen=${isFullScreen},cardTitle='Invoices',guageDiv='guage_div_invoices',totalValue=${salesInvoicedDaily},totalStyle='background-color: #0b4119;color:white;', targetValue=${salesInvoicedTargetDaily},targetStyle='background-color: #92edaa;color:black', qtyValue=${salesInvoicedQtyDaily}, qtyTarget=${salesInvoicedTargetQtyDaily},avgValue=${averageDailyOrders},avgTarget=${averageDailyOrdersTarget},avgProfitValue=${averageDailyInvoicesProfit},avgProfitTarget=${averageDailyInvoicesProfitTarget},graphDiv='graph_div_invoices')"> </div>
                      </div>   
                  </div>
                </div>
              </div>
            </main>
      </div>
  </div>
  
        <!-- Footer -->
<footer class="footer mt-auto py-3">
  <div th:replace="footerLayout :: footer"> </div>
</footer>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <!-- jQuery -->
<script type="text/javascript" src="../js/jquery.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="../js/popper.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="../js/bootstrap.js"></script>
<!-- Google chart -->
<script type="text/javascript" src="../js/loader.js"></script>
<script th:inline="javascript">
  
  /*<![CDATA[*/

  var salesOrderedDaily = /*[[${salesOrderedDaily}]]*/ '0';
  var salesInvoicedDaily = /*[[${salesInvoicedDaily}]]*/ '0';
  var salesQuotesDaily = /*[[${salesQuotesDaily}]]*/ '0';
  var salesTargetDaily = /*[[${salesTargetDaily}]]*/ '0';
  console.log('salesOrderedDaily-->'+salesOrderedDaily);
  console.log('salesInvoicedDaily-->'+salesInvoicedDaily);
  console.log('salesQuotesDaily-->'+salesQuotesDaily);
  console.log('salesTargetDaily-->'+salesTargetDaily);

  var targetAchievedOrders = /*[[${targetAchievedOrders}]]*/ 0;
  var targetAchievedQuotes = /*[[${targetAchievedQuotes}]]*/ 0;
  var targetAchievedInvoices = /*[[${targetAchievedInvoices}]]*/ 0;
  console.log('targetAchievedOrders-->'+targetAchievedOrders);
  console.log('targetAchievedQuotes-->'+targetAchievedQuotes);
  console.log('targetAchievedInvoices-->'+targetAchievedInvoices);
  
  var salesOrderTargets = /*[[${salesOrderTargets}]]*/ [];
  var salesQuoteTargets = /*[[${salesQuoteTargets}]]*/ [];
  var salesInvoiceTargets = /*[[${salesInvoiceTargets}]]*/ [];
  
  var salesOrderTargetArr = [];
  salesOrderTargetArr.push(["Date","Actual","Target","Daily Avg"]);
  for (i = 0; i < salesOrderTargets.length; i++) {
    salesOrderTargetArr.push([salesOrderTargets[i].date.split("T")[0].split("-")[2]+'/'+salesOrderTargets[i].date.split("T")[0].split("-")[1],parseFloat(salesOrderTargets[i].total.toFixed(2)),parseFloat(salesOrderTargets[i].cumulativeTarget.toFixed(2)),parseFloat(salesOrderTargets[i].averageTotal.toFixed(2))]);
  }
  console.log('salesOrderTargetArr-->'+salesOrderTargetArr);
  var salesQuoteTargetArr = [];
  salesQuoteTargetArr.push(["Date","Actual","Target","Daily Avg"]);
  for (i = 0; i < salesQuoteTargets.length; i++) {
    salesQuoteTargetArr.push([salesQuoteTargets[i].date.split("T")[0].split("-")[2]+'/'+salesQuoteTargets[i].date.split("T")[0].split("-")[1],parseFloat(salesQuoteTargets[i].total.toFixed(2)),parseFloat(salesQuoteTargets[i].cumulativeTarget.toFixed(2)),parseFloat(salesQuoteTargets[i].averageTotal.toFixed(2))]);
  }
  console.log('salesQuoteTargetArr-->'+salesQuoteTargetArr);

  var salesInvoiceTargetArr = [];
  salesInvoiceTargetArr.push(["Date","Actual","Target","Daily Avg"]);
  for (i = 0; i < salesInvoiceTargets.length; i++) {
    salesInvoiceTargetArr.push([salesInvoiceTargets[i].date.split("T")[0].split("-")[2]+'/'+salesInvoiceTargets[i].date.split("T")[0].split("-")[1],parseFloat(salesInvoiceTargets[i].total.toFixed(2)),parseFloat(salesInvoiceTargets[i].cumulativeTarget.toFixed(2)),parseFloat(salesInvoiceTargets[i].averageTotal.toFixed(2))]);
  }
  console.log('salesInvoiceTargetArr-->'+salesInvoiceTargetArr);
/*]]>*/
  google.charts.load('current', {packages: ['corechart','gauge','bar']});
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {
    // Define the chart to be drawn.
    var dataQuotes = google.visualization.arrayToDataTable([
          ['Label', 'Value'],
          ['Quotes', {v:targetAchievedQuotes,f:targetAchievedQuotes+'%'}]
        ]);

    var optionsQuotes = {
          width: 800,
          height: 220,
          redColor:'#00bfff',
          redFrom: 0,
          redTo: targetAchievedQuotes,
          greenColor:'#ff85e6',
          greenFrom:targetAchievedQuotes,
          greenTo: 100,
          minorTicks: 5
        };

        var chartQuotes = new google.visualization.Gauge(document.getElementById('guage_div_quotes'));

        chartQuotes.draw(dataQuotes, optionsQuotes);
        // Define the chart to be drawn.
    var dataOrders = google.visualization.arrayToDataTable([
          ['Label', 'Value'],
          ['Orders', {v:targetAchievedOrders,f:targetAchievedOrders+'%'}]
        ]);

    var optionsOrders = {
          width: 800,
          height: 220,
          yellowColor:'#f9ae06',
          yellowFrom: 0,
          yellowTo: targetAchievedOrders,
          greenColor:'#fff67e',
          greenFrom:targetAchievedOrders,
          greenTo: 100,
          minorTicks: 5,
        };

        var chartOrders = new google.visualization.Gauge(document.getElementById('guage_div_orders'));

        chartOrders.draw(dataOrders, optionsOrders);
            // Define the chart to be drawn.
    var dataInvoices = google.visualization.arrayToDataTable([
          ['Label', 'Value'],
          ['Invoices', {v:targetAchievedInvoices,f:targetAchievedInvoices+'%'}]
        ]);

    var optionsInvoices = {
          width: 800,
          height: 220,
          redColor:'#0b4119',
          redFrom: 0,
          redTo: targetAchievedInvoices,
          greenColor:'#92edaa',
          greenFrom:targetAchievedInvoices,
          greenTo: 100,
          minorTicks: 5
        };

        var chartInvoices = new google.visualization.Gauge(document.getElementById('guage_div_invoices'));

        chartInvoices.draw(dataInvoices, optionsInvoices);

       
        var dataGraphInvoices = google.visualization.arrayToDataTable(salesInvoiceTargetArr);

        var dataGraphInvoicesOptions = {
          width: 400,
          legend:'top',
          title: 'Sales vs Target Last 7 Days',
          vAxis: {title: 'Amount($)'},
          hAxis: {title: 'Date'},
          seriesType: 'bars',
          series: {0: {axis: 'Actual',color : '#0b4119'},1: {axis: 'Target',type: 'line',color : '#92edaa'},2: {type: 'line',color : 'red'}},
          axes: {
          // Adds labels to each axis; they don't have to match the axis names.
          y: {
            Actual: {label: 'Amount($)'},
            Target: {label: 'Amount($)'}
          }
          }
        };
        var graphInvoices = new google.visualization.ComboChart(graph_div_invoices);
        graphInvoices.draw(dataGraphInvoices, dataGraphInvoicesOptions);
          
        var dataGraphOrders = google.visualization.arrayToDataTable(salesOrderTargetArr);

        var dataGraphOrdersOptions = {
          width: 400,
          legend:'top',
          title: 'Sales vs Target Last 7 Days',
          vAxis: {title: 'Amount($)'},
          hAxis: {title: 'Date'},
          seriesType: 'bars',
          series: {0: {axis: 'Actual',color : '#f9ae06'},1: {axis: 'Target',type: 'line',color : '#fff67e'},2: {type: 'line',color : 'red'}},
          axes: {
          // Adds labels to each axis; they don't have to match the axis names.
          y: {
            Actual: {label: 'Amount($)'},
            Target: {label: 'Amount($)'}
          }
        }
        };
        var graphOrders = new google.visualization.ComboChart(graph_div_orders);
        graphOrders.draw(dataGraphOrders, dataGraphOrdersOptions);
            
        var dataGraphQuotes = google.visualization.arrayToDataTable(salesQuoteTargetArr);

        var dataGraphQuotesOptions = {
          width: 400,
          legend:'top',
          title: 'Sales vs Target',
          title: 'Sales vs Target Last 7 Days',
          vAxis: {title: 'Amount($)'},
          hAxis: {title: 'Date'},
          seriesType: 'bars',
          series: {0: {axis: 'Actual',color : '#00bfff'},1: {axis: 'Target',type: 'line',color : '#ff85e6'},2: {type: 'line',color : 'red'}},
          axes: {
          // Adds labels to each axis; they don't have to match the axis names.
          y: {
            Actual: {label: 'Amount($)'},
            Target: {label: 'Amount($)'}
          }
          }
        };
        var graphQuotes = new google.visualization.ComboChart(graph_div_quotes);
        graphQuotes.draw(dataGraphQuotes, dataGraphQuotesOptions);
  }
  
    </script>
 </body>
    </html>